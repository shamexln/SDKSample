<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Product Core System (PCS): DFL::Crypto::RoleAuthorizationList Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Product Core System (PCS)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_d_f_l.html">DFL</a></li><li class="navelem"><a class="el" href="namespace_d_f_l_1_1_crypto.html">Crypto</a></li><li class="navelem"><a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html">RoleAuthorizationList</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_d_f_l_1_1_crypto_1_1_role_authorization_list-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DFL::Crypto::RoleAuthorizationList Class Reference<div class="ingroups"><a class="el" href="group___s32__group.html">S32</a> &raquo; <a class="el" href="group___crypto.html">Crypto</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Holds a string which specifies the roles a specific vendor is allowed to have.  
 <a href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_role_authorization_list_8h_source.html">Framework/Crypto/Public/RoleAuthorizationList.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3ee28774462866108572cf507ab534b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a> ()=default</td></tr>
<tr class="memdesc:a3ee28774462866108572cf507ab534b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates an empty role authorization list.  <a href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">More...</a><br /></td></tr>
<tr class="separator:a3ee28774462866108572cf507ab534b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b765a5450313f55629f5acdfdd37a58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a4b765a5450313f55629f5acdfdd37a58">RoleAuthorizationList</a> (std::string <a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>)</td></tr>
<tr class="memdesc:a4b765a5450313f55629f5acdfdd37a58"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a role authorization list from str.  <a href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a4b765a5450313f55629f5acdfdd37a58">More...</a><br /></td></tr>
<tr class="separator:a4b765a5450313f55629f5acdfdd37a58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2299822e8f5a250ffb61d44d697591c4"><td class="memItemLeft" align="right" valign="top">const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a> () const noexcept</td></tr>
<tr class="memdesc:a2299822e8f5a250ffb61d44d697591c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the string given on construction.  <a href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">More...</a><br /></td></tr>
<tr class="separator:a2299822e8f5a250ffb61d44d697591c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeca21ce4b4a15fb3dcfb62891bd29a80"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#aeca21ce4b4a15fb3dcfb62891bd29a80">empty</a> () const noexcept</td></tr>
<tr class="memdesc:aeca21ce4b4a15fb3dcfb62891bd29a80"><td class="mdescLeft">&#160;</td><td class="mdescRight">True if this RAL is empty otherwise false.  <a href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#aeca21ce4b4a15fb3dcfb62891bd29a80">More...</a><br /></td></tr>
<tr class="separator:aeca21ce4b4a15fb3dcfb62891bd29a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefb8640434ff80556433fbfa94993282"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#aefb8640434ff80556433fbfa94993282">valid</a> () const</td></tr>
<tr class="memdesc:aefb8640434ff80556433fbfa94993282"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if verification of signature succeeds, otherwise false.  <a href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#aefb8640434ff80556433fbfa94993282">More...</a><br /></td></tr>
<tr class="separator:aefb8640434ff80556433fbfa94993282"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce097914e5f2486a1b306e66d20567d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a9ce097914e5f2486a1b306e66d20567d">containsRoleFor</a> (const <a class="el" href="class_d_f_l_1_1_crypto_1_1_certificates.html">Certificates</a> &amp;certs, const <a class="el" href="class_d_f_l_1_1_oid.html">Oid</a> &amp;role, std::error_code &amp;ec) const</td></tr>
<tr class="memdesc:a9ce097914e5f2486a1b306e66d20567d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if role could be found for given certificates, otherwise false. Returns always true if given certificates contain Draeger device root.  <a href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a9ce097914e5f2486a1b306e66d20567d">More...</a><br /></td></tr>
<tr class="separator:a9ce097914e5f2486a1b306e66d20567d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5fa945cdbbb127110b526c25e8e20cd"><td class="memItemLeft" align="right" valign="top"><a id="ac5fa945cdbbb127110b526c25e8e20cd"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#ac5fa945cdbbb127110b526c25e8e20cd">equals</a> (const <a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html">RoleAuthorizationList</a> &amp;other) const noexcept</td></tr>
<tr class="memdesc:ac5fa945cdbbb127110b526c25e8e20cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if other is equal to *this, otherwise false. <br /></td></tr>
<tr class="separator:ac5fa945cdbbb127110b526c25e8e20cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1aedc8e3ea6162ca51ed9c257947d0c"><td class="memItemLeft" align="right" valign="top"><a id="aa1aedc8e3ea6162ca51ed9c257947d0c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#aa1aedc8e3ea6162ca51ed9c257947d0c">swap</a> (<a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html">RoleAuthorizationList</a> &amp;other) noexcept</td></tr>
<tr class="memdesc:aa1aedc8e3ea6162ca51ed9c257947d0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Swaps content of other with this. <br /></td></tr>
<tr class="separator:aa1aedc8e3ea6162ca51ed9c257947d0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0d120939a48b9dfe655e7da598f324a5"><td class="memItemLeft" align="right" valign="top"><a id="a0d120939a48b9dfe655e7da598f324a5"></a>
std::string&#160;</td><td class="memItemRight" valign="bottom"><b>m_str</b> {}</td></tr>
<tr class="separator:a0d120939a48b9dfe655e7da598f324a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a775de7db5da0dd53792e895ca19e2ddc"><td class="memItemLeft" align="right" valign="top"><a id="a775de7db5da0dd53792e895ca19e2ddc"></a>
<a class="el" href="class_d_f_l_1_1_crypto_1_1_impl_1_1_ral_1_1_type.html">Impl::Ral::Type</a>&#160;</td><td class="memItemRight" valign="bottom"><b>m_ral</b> {}</td></tr>
<tr class="separator:a775de7db5da0dd53792e895ca19e2ddc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Holds a string which specifies the roles a specific vendor is allowed to have. </p>
<p>In short this type is referred to as RAL and the format of the string has to be: </p><div class="fragment"><div class="line">&lt;Comment&gt;\n</div>
<div class="line">&lt;Fingerprint_1&gt;;&lt;Role_1&gt;,&lt;Role_2&gt;, ...\n</div>
<div class="line">&lt;Fingerprint_2&gt;;&lt;Role_3&gt;,&lt;Role_4&gt;, ...\n</div>
<div class="line">&lt;Fingerprint_n&gt;;&lt;Role_x&gt;,&lt;Role_y&gt;, ...\n</div>
<div class="line">&lt;Signature&gt;\n</div>
</div><!-- fragment --><p>The format of the tags used above is:</p><ul>
<li>&lt;Comment&gt; String of arbitrary length</li>
<li>&lt;Fingerprint&gt; Hexadecimal string of length 64</li>
<li>&lt;Role&gt; String containing an OID in dot notation (see <a class="el" href="class_d_f_l_1_1_oid.html">DFL::Oid</a>)</li>
<li>&lt;Signature&gt; Empty or hexadecimal string of length 512</li>
</ul>
<p>Example string: </p><div class="fragment"><div class="line">This is a comment\n</div>
<div class="line">6bd2915e982d309d3f8fd7baa501c36ba4c4770c06f5225db846a82b10e9db54;1.3.6.1.5.5.7.3.1,1.3.6.1.5.5.7.3.2,1.2.840.10004.20701.1.1,1.2.840.10004.20701.1.2\n</div>
<div class="line">46e197999cd98ecbec047bb499aa9926a8803baa2aadb566183ad064f902cdbc6c6967bcc1c4fa81a62126fd9ea252e2bdc9713114b1e4571a96754c02ef62c5ae5c4f62080cc671d732cb619802d58150ebccdc67f94424f53ba5f4a79986b81a588f73ac5afb621b75bdf92de275972b86347c9653126d9d111c590015258fd86e1715c26452df16511c044e3a6b45872deace3a9f50e9f43e82dec72a0c86b708bf8309eee23b0b8ae824102207182f02b345c3e53ae98b1ca2f2c9a751c0a23ac89be95725771d6b10cd7536e4c8d073b1ada1f5fb8dc59bd52df2948373b58ed13d0dc034938204c7326c38a76698f8888daec10a1b378c87154e02623d\n</div>
</div><!-- fragment --><p>The vendor is specified by the fingerprint of its CA. To verify the correctness of this list it is signed by an RSA-2048 algorithm. The verification of the signature is done by the valid function, not during construction. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3ee28774462866108572cf507ab534b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ee28774462866108572cf507ab534b5">&#9670;&nbsp;</a></span>RoleAuthorizationList() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DFL::Crypto::RoleAuthorizationList::RoleAuthorizationList </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates an empty role authorization list. </p>
<p>A default constructed role authorization list is always valid.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a> ral{};</div>
<div class="line">    EXPECT_EQ(ral.str(), std::string{});</div>
<div class="line">    EXPECT_TRUE(ral.valid());</div>
<div class="line">    EXPECT_TRUE(ral.empty());</div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_role_authorization_list_html_a3ee28774462866108572cf507ab534b5"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">DFL::Crypto::RoleAuthorizationList::RoleAuthorizationList</a></div><div class="ttdeci">RoleAuthorizationList()=default</div><div class="ttdoc">Creates an empty role authorization list.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b765a5450313f55629f5acdfdd37a58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b765a5450313f55629f5acdfdd37a58">&#9670;&nbsp;</a></span>RoleAuthorizationList() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DFL::Crypto::RoleAuthorizationList::RoleAuthorizationList </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a role authorization list from str. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>On invalid format of str.</td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line">    EXPECT_EQ(<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a>{}, <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a>{std::string{}});</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> std::string strCom{<span class="stringliteral">&quot;Homer&#39;s Authority&quot;</span>};</div>
<div class="line">        <span class="keyword">const</span> std::string strFp(64, <span class="charliteral">&#39;f&#39;</span>);</div>
<div class="line">        <span class="keyword">const</span> std::string strRole{<span class="stringliteral">&quot;1.2.3&quot;</span>};</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> std::string strSig(512, <span class="charliteral">&#39;f&#39;</span>);</div>
<div class="line">            <span class="keyword">const</span> std::string <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>{strCom + <span class="charliteral">&#39;\n&#39;</span> +</div>
<div class="line">                                  strFp + <span class="charliteral">&#39;;&#39;</span> + strRole + <span class="charliteral">&#39;,&#39;</span> + strRole + <span class="charliteral">&#39;\n&#39;</span> +</div>
<div class="line">                                  strSig + <span class="charliteral">&#39;\n&#39;</span>};</div>
<div class="line">            EXPECT_EQ(<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a>{<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>}.str(), <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>);</div>
<div class="line">        }</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> std::string strSigEmpty{};</div>
<div class="line">            <span class="keyword">const</span> std::string <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>{strCom + <span class="charliteral">&#39;\n&#39;</span> +</div>
<div class="line">                                  strFp + <span class="charliteral">&#39;;&#39;</span> + strRole + <span class="charliteral">&#39;,&#39;</span> + strRole + <span class="charliteral">&#39;\n&#39;</span> +</div>
<div class="line">                                  strSigEmpty + <span class="charliteral">&#39;\n&#39;</span>};</div>
<div class="line">            EXPECT_EQ(<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a>{<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>}.str(), <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_role_authorization_list_html_a2299822e8f5a250ffb61d44d697591c4"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">DFL::Crypto::RoleAuthorizationList::str</a></div><div class="ttdeci">const std::string &amp; str() const noexcept</div><div class="ttdoc">Returns the string given on construction.</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9ce097914e5f2486a1b306e66d20567d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ce097914e5f2486a1b306e66d20567d">&#9670;&nbsp;</a></span>containsRoleFor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DFL::Crypto::RoleAuthorizationList::containsRoleFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_crypto_1_1_certificates.html">Certificates</a> &amp;&#160;</td>
          <td class="paramname"><em>certs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_oid.html">Oid</a> &amp;&#160;</td>
          <td class="paramname"><em>role</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::error_code &amp;&#160;</td>
          <td class="paramname"><em>ec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if role could be found for given certificates, otherwise false. Returns always true if given certificates contain Draeger device root. </p>
<p>Iterates over the given certificates and creates a fingerprint from each of them. Then each fingerprint is looked up within the RAL. If a fingerprint is found the according roles are then checked if they contain the given role. Then and only then this function returns true. In case of returning false the provided error code is filled with a value representing the cause of the failure. For details look at <a class="el" href="group___crypto.html#gafb6708ed6a089ad179f9c0e330977a43">DFL::Crypto::Error::Ral</a>.</p>
<div class="fragment"><div class="line">    EXPECT_TRUE(m_fakeSignedRal.containsRoleFor(certs, role, ec));</div>
<div class="line">    EXPECT_FALSE(ec);</div>
<div class="line">    EXPECT_EQ(ec, <a class="code" href="namespace_d_f_l_1_1_log.html#a5e7374ead8b46145e24d795919466585">Ral::Success</a>);</div>
<div class="ttc" id="anamespace_d_f_l_1_1_log_html_a5e7374ead8b46145e24d795919466585"><div class="ttname"><a href="namespace_d_f_l_1_1_log.html#a5e7374ead8b46145e24d795919466585">DFL::Log::Success</a></div><div class="ttdeci">DFL_LOG_EXPIMP SuccessType const Success</div><div class="ttdoc">Indicates the successful completion of an transaction.</div></div>
</div><!-- fragment --><div class="fragment"><div class="line">    EXPECT_FALSE(m_fakeSignedRal.containsRoleFor(certs, nonexistingRole, ec));</div>
<div class="line">    EXPECT_TRUE(ec);</div>
<div class="line">    EXPECT_EQ(ec, Ral::RoleNotFound);</div>
</div><!-- fragment --><div class="fragment"><div class="line">    EXPECT_FALSE(m_fakeSignedRal.containsRoleFor(emptyCerts, role, ec));</div>
<div class="line">    EXPECT_TRUE(ec);</div>
<div class="line">    EXPECT_EQ(ec, Ral::FingerprintNotFound);</div>
</div><!-- fragment --><div class="fragment"><div class="line">    EXPECT_TRUE(m_fakeSignedRal.containsRoleFor(certsWithDraegerDeviceRoot,</div>
<div class="line">                                                nonexistingRole,</div>
<div class="line">                                                ec));</div>
<div class="line">    EXPECT_FALSE(ec);</div>
<div class="line">    EXPECT_EQ(ec, <a class="code" href="namespace_d_f_l_1_1_log.html#a5e7374ead8b46145e24d795919466585">Ral::Success</a>);</div>
</div><!-- fragment --><p> If called on an empty instance, only returns true if given certificates contain Draeger device root. Otherwise false is returned.</p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a> emptyRal{};</div>
<div class="line">    EXPECT_TRUE(emptyRal.containsRoleFor(certsWithDraegerDeviceRoot, role, ec));</div>
<div class="line">    EXPECT_FALSE(ec);</div>
<div class="line">    EXPECT_EQ(ec, <a class="code" href="namespace_d_f_l_1_1_log.html#a5e7374ead8b46145e24d795919466585">Ral::Success</a>);</div>
<div class="line"> </div>
<div class="line">    EXPECT_FALSE(emptyRal.containsRoleFor(certs, role, ec));</div>
<div class="line">    EXPECT_TRUE(ec);</div>
<div class="line">    EXPECT_EQ(ec, Ral::FingerprintNotFound);</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeca21ce4b4a15fb3dcfb62891bd29a80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeca21ce4b4a15fb3dcfb62891bd29a80">&#9670;&nbsp;</a></span>empty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool DFL::Crypto::RoleAuthorizationList::empty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>True if this RAL is empty otherwise false. </p>
<div class="fragment"><div class="line">    <span class="keyword">const</span> <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a> a{};</div>
<div class="line">    EXPECT_TRUE(a.empty());</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a> b{<span class="stringliteral">&quot;&quot;</span>};</div>
<div class="line">    EXPECT_TRUE(b.empty());</div>
<div class="line"> </div>
<div class="line">    EXPECT_FALSE(m_fakeSignedRal.empty());</div>
<div class="line">    EXPECT_FALSE(m_realSignedRal.empty());</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2299822e8f5a250ffb61d44d697591c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2299822e8f5a250ffb61d44d697591c4">&#9670;&nbsp;</a></span>str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string&amp; DFL::Crypto::RoleAuthorizationList::str </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the string given on construction. </p>
<div class="fragment"><div class="line">    EXPECT_EQ(<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a>{}, <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a>{std::string{}});</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> std::string strCom{<span class="stringliteral">&quot;Homer&#39;s Authority&quot;</span>};</div>
<div class="line">        <span class="keyword">const</span> std::string strFp(64, <span class="charliteral">&#39;f&#39;</span>);</div>
<div class="line">        <span class="keyword">const</span> std::string strRole{<span class="stringliteral">&quot;1.2.3&quot;</span>};</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> std::string strSig(512, <span class="charliteral">&#39;f&#39;</span>);</div>
<div class="line">            <span class="keyword">const</span> std::string <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>{strCom + <span class="charliteral">&#39;\n&#39;</span> +</div>
<div class="line">                                  strFp + <span class="charliteral">&#39;;&#39;</span> + strRole + <span class="charliteral">&#39;,&#39;</span> + strRole + <span class="charliteral">&#39;\n&#39;</span> +</div>
<div class="line">                                  strSig + <span class="charliteral">&#39;\n&#39;</span>};</div>
<div class="line">            EXPECT_EQ(<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a>{<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>}.str(), <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>);</div>
<div class="line">        }</div>
<div class="line">        {</div>
<div class="line">            <span class="keyword">const</span> std::string strSigEmpty{};</div>
<div class="line">            <span class="keyword">const</span> std::string <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>{strCom + <span class="charliteral">&#39;\n&#39;</span> +</div>
<div class="line">                                  strFp + <span class="charliteral">&#39;;&#39;</span> + strRole + <span class="charliteral">&#39;,&#39;</span> + strRole + <span class="charliteral">&#39;\n&#39;</span> +</div>
<div class="line">                                  strSigEmpty + <span class="charliteral">&#39;\n&#39;</span>};</div>
<div class="line">            EXPECT_EQ(<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a>{<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>}.str(), <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a2299822e8f5a250ffb61d44d697591c4">str</a>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aefb8640434ff80556433fbfa94993282"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefb8640434ff80556433fbfa94993282">&#9670;&nbsp;</a></span>valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DFL::Crypto::RoleAuthorizationList::valid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if verification of signature succeeds, otherwise false. </p>
<p>An empty role authorization list is always valid.</p>
<div class="fragment"><div class="line">    EXPECT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a>{}.valid());</div>
<div class="line">    EXPECT_FALSE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a>{strRalEmptySig}.valid());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// The following RAL objects contain a valid payload and signature.</span></div>
<div class="line">    <span class="comment">// One is signed by the production key and the other by the mock key.</span></div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a> ralProdSig{strRalProdSig};</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html#a3ee28774462866108572cf507ab534b5">RoleAuthorizationList</a> ralMockSig{strRalMockSig};</div>
<div class="line">    <span class="comment">// By default the production key is used for verification.</span></div>
<div class="line">    EXPECT_TRUE(ralProdSig.valid());</div>
<div class="line">    EXPECT_FALSE(ralMockSig.valid());</div>
<div class="line">    <span class="comment">// Now use the mock key for verification.</span></div>
<div class="line">    <span class="keyword">const</span> MockRalPublicKey _{m_ralWithFakeKey.m_publicKey};</div>
<div class="line">    EXPECT_FALSE(ralProdSig.valid());</div>
<div class="line">    EXPECT_TRUE(ralMockSig.valid());</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Framework/Crypto/Public/<a class="el" href="_role_authorization_list_8h_source.html">RoleAuthorizationList.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 13 2023 13:32:06 for Product Core System (PCS) by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
