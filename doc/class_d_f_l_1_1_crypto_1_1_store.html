<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Product Core System (PCS): DFL::Crypto::Store Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Product Core System (PCS)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_d_f_l.html">DFL</a></li><li class="navelem"><a class="el" href="namespace_d_f_l_1_1_crypto.html">Crypto</a></li><li class="navelem"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html">Store</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="class_d_f_l_1_1_crypto_1_1_store-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DFL::Crypto::Store Class Reference<div class="ingroups"><a class="el" href="group___s32__group.html">S32</a> &raquo; <a class="el" href="group___crypto.html">Crypto</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Stores the necessary states (key-pair, CSR, certificate, ...) to be able to obtain a signed certificate from a PKI as well as authorization configurations like whitelists, third-party CAs and RALs.  
 <a href="class_d_f_l_1_1_crypto_1_1_store.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_public_2_store_8h_source.html">Framework/Crypto/Public/Store.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:ac9bab95b0a085336cb36085264b8e349"><td class="memItemLeft" align="right" valign="top"><a id="ac9bab95b0a085336cb36085264b8e349"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#ac9bab95b0a085336cb36085264b8e349">OptionalCsr</a> = boost::optional&lt; <a class="el" href="class_d_f_l_1_1_crypto_1_1_csr.html">Csr</a> &gt;</td></tr>
<tr class="memdesc:ac9bab95b0a085336cb36085264b8e349"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optional CSR. <br /></td></tr>
<tr class="separator:ac9bab95b0a085336cb36085264b8e349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61760874d25d8cbd76a1eca1a2bd976b"><td class="memItemLeft" align="right" valign="top"><a id="a61760874d25d8cbd76a1eca1a2bd976b"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a61760874d25d8cbd76a1eca1a2bd976b">OptionalTable</a> = boost::optional&lt; <a class="el" href="class_d_f_l_1_1_crypto_1_1_table.html">Table</a> &gt;</td></tr>
<tr class="memdesc:a61760874d25d8cbd76a1eca1a2bd976b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Optional <a class="el" href="class_d_f_l_1_1_crypto_1_1_table.html" title="Holds an DFL::Application::Identifier plus a container of DFL::Crypto::TableItem without duplicates.">Table</a>. <br /></td></tr>
<tr class="separator:a61760874d25d8cbd76a1eca1a2bd976b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a40a548e42a4eac15b778732ab26bf4fe"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_d_f_l_1_1_crypto_1_1_table.html">Table</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">table</a> ()</td></tr>
<tr class="memdesc:a40a548e42a4eac15b778732ab26bf4fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the storage table.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">More...</a><br /></td></tr>
<tr class="separator:a40a548e42a4eac15b778732ab26bf4fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01a9518169285ec7188d23ccfc7493ae"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a61760874d25d8cbd76a1eca1a2bd976b">OptionalTable</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a01a9518169285ec7188d23ccfc7493ae">table</a> (std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a01a9518169285ec7188d23ccfc7493ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the storage table.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a01a9518169285ec7188d23ccfc7493ae">More...</a><br /></td></tr>
<tr class="separator:a01a9518169285ec7188d23ccfc7493ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09bfe0554ac3ca4e9d90a50a6d909a47"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a09bfe0554ac3ca4e9d90a50a6d909a47">applicationIdentifier</a> (const <a class="el" href="class_d_f_l_1_1_application_1_1_identifier.html">Application::Identifier</a> &amp;id, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a09bfe0554ac3ca4e9d90a50a6d909a47"><td class="mdescLeft">&#160;</td><td class="mdescRight">Changes the application id in the storage table.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a09bfe0554ac3ca4e9d90a50a6d909a47">More...</a><br /></td></tr>
<tr class="separator:a09bfe0554ac3ca4e9d90a50a6d909a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b131ca8d9fadb0fd7941fa37e4d806f"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a3b131ca8d9fadb0fd7941fa37e4d806f">certificateChain</a> (const <a class="el" href="class_d_f_l_1_1_crypto_1_1_certificate_chain.html">CertificateChain</a> &amp;chain)</td></tr>
<tr class="memdesc:a3b131ca8d9fadb0fd7941fa37e4d806f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the given chain to the storage table.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a3b131ca8d9fadb0fd7941fa37e4d806f">More...</a><br /></td></tr>
<tr class="separator:a3b131ca8d9fadb0fd7941fa37e4d806f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17cd06cd6ce77204b28d03a9d561dbde"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a17cd06cd6ce77204b28d03a9d561dbde">certificateChain</a> (const <a class="el" href="class_d_f_l_1_1_crypto_1_1_certificate_chain.html">CertificateChain</a> &amp;chain, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a17cd06cd6ce77204b28d03a9d561dbde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the given chain to the storage table.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a17cd06cd6ce77204b28d03a9d561dbde">More...</a><br /></td></tr>
<tr class="separator:a17cd06cd6ce77204b28d03a9d561dbde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bf7f32504c045c84535438dbc08e468"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a3bf7f32504c045c84535438dbc08e468">removeCertificateChainFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a3bf7f32504c045c84535438dbc08e468"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the chain for the given requester.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a3bf7f32504c045c84535438dbc08e468">More...</a><br /></td></tr>
<tr class="separator:a3bf7f32504c045c84535438dbc08e468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ce3dc585ffef10ccac920b1aa985596"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a7ce3dc585ffef10ccac920b1aa985596">clear</a> ()</td></tr>
<tr class="memdesc:a7ce3dc585ffef10ccac920b1aa985596"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the entire contents of the store.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a7ce3dc585ffef10ccac920b1aa985596">More...</a><br /></td></tr>
<tr class="separator:a7ce3dc585ffef10ccac920b1aa985596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4e5ae6dc285f026019ee76e873e6d3f"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#af4e5ae6dc285f026019ee76e873e6d3f">csrDeployedFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester)</td></tr>
<tr class="memdesc:af4e5ae6dc285f026019ee76e873e6d3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the CSR deploy timestamp for the given requester to now.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#af4e5ae6dc285f026019ee76e873e6d3f">More...</a><br /></td></tr>
<tr class="separator:af4e5ae6dc285f026019ee76e873e6d3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a0b0de7a5330da5881b089aba579cc9"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a6a0b0de7a5330da5881b089aba579cc9">csrDeployedFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a6a0b0de7a5330da5881b089aba579cc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the CSR deploy timestamp for the given requester to now.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a6a0b0de7a5330da5881b089aba579cc9">More...</a><br /></td></tr>
<tr class="separator:a6a0b0de7a5330da5881b089aba579cc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac95b7268df813c62d4a870c8dc33537d"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#ac95b7268df813c62d4a870c8dc33537d">generateKeys</a> ()</td></tr>
<tr class="memdesc:ac95b7268df813c62d4a870c8dc33537d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates keys for items in the table which need keys.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#ac95b7268df813c62d4a870c8dc33537d">More...</a><br /></td></tr>
<tr class="separator:ac95b7268df813c62d4a870c8dc33537d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31d2e5d5aaf15ab98847f0ab11b71414"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a31d2e5d5aaf15ab98847f0ab11b71414">removeKeyFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a31d2e5d5aaf15ab98847f0ab11b71414"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes key for the given requester.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a31d2e5d5aaf15ab98847f0ab11b71414">More...</a><br /></td></tr>
<tr class="separator:a31d2e5d5aaf15ab98847f0ab11b71414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a173a5a366b1352a7f18d8e39a69f44"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#ac9bab95b0a085336cb36085264b8e349">OptionalCsr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a8a173a5a366b1352a7f18d8e39a69f44">generateCsrFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a8a173a5a366b1352a7f18d8e39a69f44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a certificate signing request based on the given requestor.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a8a173a5a366b1352a7f18d8e39a69f44">More...</a><br /></td></tr>
<tr class="separator:a8a173a5a366b1352a7f18d8e39a69f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45e91573073d36a65b5f12b958a5b827"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">requestCertificateFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, const <a class="el" href="group___crypto.html#ga38d524ff4b8ecbb39379e33c25bfb5dc">CommonName</a> &amp;cn, const <a class="el" href="class_d_f_l_1_1_oids.html">Oids</a> &amp;roles=<a class="el" href="class_d_f_l_1_1_oids.html">Oids</a>{})</td></tr>
<tr class="memdesc:a45e91573073d36a65b5f12b958a5b827"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds the given certificate requester to the storage table.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">More...</a><br /></td></tr>
<tr class="separator:a45e91573073d36a65b5f12b958a5b827"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a367a8a86db8f540beab5b548c6b0a95a"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a367a8a86db8f540beab5b548c6b0a95a">whitelistFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, const <a class="el" href="class_d_f_l_1_1_crypto_1_1_whitelist.html">Whitelist</a> &amp;list)</td></tr>
<tr class="memdesc:a367a8a86db8f540beab5b548c6b0a95a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a white list for the given requester to the storage table.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a367a8a86db8f540beab5b548c6b0a95a">More...</a><br /></td></tr>
<tr class="separator:a367a8a86db8f540beab5b548c6b0a95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91c8135f758c52294727cf774380f979"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a91c8135f758c52294727cf774380f979">whitelistFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, const <a class="el" href="class_d_f_l_1_1_crypto_1_1_whitelist.html">Whitelist</a> &amp;list, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a91c8135f758c52294727cf774380f979"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a white list for the given requester to the storage table.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a91c8135f758c52294727cf774380f979">More...</a><br /></td></tr>
<tr class="separator:a91c8135f758c52294727cf774380f979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b9d74c95b1f652ffff89c06abc81723"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a9b9d74c95b1f652ffff89c06abc81723">rootCasFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, const <a class="el" href="group___crypto.html#ga7731f2c7313c473dc54a1918564a06a1">RootCas</a> &amp;rootCas, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a9b9d74c95b1f652ffff89c06abc81723"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds root cas for the given requester to the storage table.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a9b9d74c95b1f652ffff89c06abc81723">More...</a><br /></td></tr>
<tr class="separator:a9b9d74c95b1f652ffff89c06abc81723"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fd2666f9f67d44aa654253a52136ad9"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a8fd2666f9f67d44aa654253a52136ad9">removeAllRootCasFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a8fd2666f9f67d44aa654253a52136ad9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove all root cas for the given requester.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a8fd2666f9f67d44aa654253a52136ad9">More...</a><br /></td></tr>
<tr class="separator:a8fd2666f9f67d44aa654253a52136ad9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7708024c7bb522acb4bd0fad49d9067e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a7708024c7bb522acb4bd0fad49d9067e">roleAuthorizationListFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, const <a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html">RoleAuthorizationList</a> &amp;ral, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a7708024c7bb522acb4bd0fad49d9067e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a role authorization list for the given requester to the storage table.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a7708024c7bb522acb4bd0fad49d9067e">More...</a><br /></td></tr>
<tr class="separator:a7708024c7bb522acb4bd0fad49d9067e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fb8b1e31ea2a2dff01c1ddffcb7bb2e"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a8fb8b1e31ea2a2dff01c1ddffcb7bb2e">removeRoleAuthorizationListFor</a> (const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;requester, std::string &amp;errorMessage)</td></tr>
<tr class="memdesc:a8fb8b1e31ea2a2dff01c1ddffcb7bb2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove role authorization list for the given requester.  <a href="class_d_f_l_1_1_crypto_1_1_store.html#a8fb8b1e31ea2a2dff01c1ddffcb7bb2e">More...</a><br /></td></tr>
<tr class="separator:a8fb8b1e31ea2a2dff01c1ddffcb7bb2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Stores the necessary states (key-pair, CSR, certificate, ...) to be able to obtain a signed certificate from a PKI as well as authorization configurations like whitelists, third-party CAs and RALs. </p>
<p>The workflow on how to obtain a signed certificate is documented in the library documentation.</p>
<p>Since the store persists sensitive data (private keys of the certificates) it is encrypted using <a class="el" href="class_d_f_l_1_1_crypto_1_1_cipher_1_1_symmetric_1_1_device_specific.html">DFL::Crypto::Cipher::Symmetric::DeviceSpecific</a>. Please read its documentation to check what encryption method is used on your platform and how to customize it if it is not secure enough for this need.</p>
<p><a class="el" href="class_d_f_l_1_1_crypto_1_1_environment.html#aaa93d33dd863248f0442fea8e8d30558">DFL::Crypto::Environment::config</a> is used to configure the path where the store data is saved in.</p>
<dl class="section note"><dt>Note</dt><dd>There can only be one store per process. If all processes shall be using the same store than ensure that all processes use the same file path. In general access to the file is protected by an interprocess mutex. </dd></dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a09bfe0554ac3ca4e9d90a50a6d909a47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09bfe0554ac3ca4e9d90a50a6d909a47">&#9670;&nbsp;</a></span>applicationIdentifier()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::applicationIdentifier </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_application_1_1_identifier.html">Application::Identifier</a> &amp;&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Changes the application id in the storage table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">id</td><td></td></tr>
    <tr><td class="paramname">errorMessage</td><td>If the function returns false, this string will contain a detailed error message</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

</div>
</div>
<a id="a3b131ca8d9fadb0fd7941fa37e4d806f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b131ca8d9fadb0fd7941fa37e4d806f">&#9670;&nbsp;</a></span>certificateChain() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::certificateChain </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_crypto_1_1_certificate_chain.html">CertificateChain</a> &amp;&#160;</td>
          <td class="paramname"><em>chain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds the given chain to the storage table. </p>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

</div>
</div>
<a id="a17cd06cd6ce77204b28d03a9d561dbde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17cd06cd6ce77204b28d03a9d561dbde">&#9670;&nbsp;</a></span>certificateChain() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::certificateChain </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_crypto_1_1_certificate_chain.html">CertificateChain</a> &amp;&#160;</td>
          <td class="paramname"><em>chain</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds the given chain to the storage table. </p>
<dl class="section note"><dt>Note</dt><dd>The requester will be identified by the public key within the given chain.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">chain</td><td></td></tr>
    <tr><td class="paramname">errorMessage</td><td>If the function returns false, this string will contain a detailed error message</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

</div>
</div>
<a id="a7ce3dc585ffef10ccac920b1aa985596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ce3dc585ffef10ccac920b1aa985596">&#9670;&nbsp;</a></span>clear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clears the entire contents of the store. </p>
<dl class="section note"><dt>Note</dt><dd>To bring the store back into operation, it is necessary to reinitialize the library (see <a class="el" href="class_d_f_l_1_1_crypto_1_1_environment.html">DFL::Crypto::Environment</a>)!</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

</div>
</div>
<a id="af4e5ae6dc285f026019ee76e873e6d3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4e5ae6dc285f026019ee76e873e6d3f">&#9670;&nbsp;</a></span>csrDeployedFor() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::csrDeployedFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the CSR deploy timestamp for the given requester to now. </p>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

</div>
</div>
<a id="a6a0b0de7a5330da5881b089aba579cc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a0b0de7a5330da5881b089aba579cc9">&#9670;&nbsp;</a></span>csrDeployedFor() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::csrDeployedFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the CSR deploy timestamp for the given requester to now. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">requester</td><td></td></tr>
    <tr><td class="paramname">errorMessage</td><td>If the function returns false, this string will contain a detailed error message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

</div>
</div>
<a id="a8a173a5a366b1352a7f18d8e39a69f44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a173a5a366b1352a7f18d8e39a69f44">&#9670;&nbsp;</a></span>generateCsrFor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#ac9bab95b0a085336cb36085264b8e349">OptionalCsr</a> DFL::Crypto::Store::generateCsrFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates a certificate signing request based on the given requestor. </p>
<p>This can only be successful if the requester is found in the store and if keys have already been generated. If the function returns 'none' errorMessage will contain a detailed description.</p>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="comment">// no application identifier, no requester, no private key</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> csr{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a8a173a5a366b1352a7f18d8e39a69f44">Store::generateCsrFor</a>(compKey, msg)};</div>
<div class="line">        EXPECT_FALSE(csr) &lt;&lt; msg;</div>
<div class="line">        EXPECT_FALSE(msg.empty());</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> result{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a09bfe0554ac3ca4e9d90a50a6d909a47">Store::applicationIdentifier</a>(<span class="keywordtype">id</span>, msg)};</div>
<div class="line">        EXPECT_TRUE(result) &lt;&lt; msg;</div>
<div class="line">        EXPECT_TRUE(msg.empty());</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// application identifier available, no requester, no private key</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> csr{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a8a173a5a366b1352a7f18d8e39a69f44">Store::generateCsrFor</a>(compKey, msg)};</div>
<div class="line">        EXPECT_FALSE(csr) &lt;&lt; msg;</div>
<div class="line">        EXPECT_FALSE(msg.empty());</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">        EXPECT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(compKey, commonName, <a class="code" href="group___s31_sdc_common.html#gab3f64a46ac4232cc4d580db3bef9a44c">roles</a>));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// application identifier available, requester available, no private key</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> csr{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a8a173a5a366b1352a7f18d8e39a69f44">Store::generateCsrFor</a>(compKey, msg)};</div>
<div class="line">        EXPECT_FALSE(csr) &lt;&lt; msg;</div>
<div class="line">        EXPECT_FALSE(msg.empty());</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">        EXPECT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#ac95b7268df813c62d4a870c8dc33537d">Store::generateKeys</a>());</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// application identifier available, requester available, private key</span></div>
<div class="line">        <span class="comment">// available</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> csr{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a8a173a5a366b1352a7f18d8e39a69f44">Store::generateCsrFor</a>(compKey, msg)};</div>
<div class="line">        EXPECT_TRUE(csr) &lt;&lt; msg;</div>
<div class="line">        EXPECT_TRUE(msg.empty());</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> DistinguishedName dn{<a class="code" href="class_d_f_l_1_1_crypto_1_1_distinguished_name.html#aa089ee7010696ec7f32bafee5bf500a4">DistinguishedName::createDn</a>()</div>
<div class="line">                                       .country(<span class="stringliteral">&quot;DE&quot;</span>)</div>
<div class="line">                                       .organization(<span class="stringliteral">&quot;Draeger&quot;</span>)</div>
<div class="line">                                       .organizationalUnit(std::string{<span class="stringliteral">&quot;MN=&quot;</span>} +</div>
<div class="line">                                                           matNum +</div>
<div class="line">                                                           <span class="stringliteral">&quot;,VER=1.2,SVC=17&quot;</span>)</div>
<div class="line">                                       .commonName(commonName.value())</div>
<div class="line">                                       .userId(serNum)};</div>
<div class="line">        EXPECT_EQ(dn, csr-&gt;subject());</div>
<div class="line">        EXPECT_EQ(0L, csr-&gt;version());</div>
<div class="line">        EXPECT_EQ(<a class="code" href="group___s31_sdc_common.html#gab3f64a46ac4232cc4d580db3bef9a44c">roles</a>, csr-&gt;extendedKeyUsageOids());</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">static_cast&lt;</span><span class="keywordtype">void</span><span class="keyword">&gt;</span>(findPrivateKey(PublicKey{*csr}));</div>
<div class="line">    }</div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_distinguished_name_html_aa089ee7010696ec7f32bafee5bf500a4"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_distinguished_name.html#aa089ee7010696ec7f32bafee5bf500a4">DFL::Crypto::DistinguishedName::createDn</a></div><div class="ttdeci">static DistinguishedNameBuilder createDn()</div><div class="ttdoc">Initializes distinguished name piece by piece.</div></div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_a09bfe0554ac3ca4e9d90a50a6d909a47"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#a09bfe0554ac3ca4e9d90a50a6d909a47">DFL::Crypto::Store::applicationIdentifier</a></div><div class="ttdeci">static bool applicationIdentifier(const Application::Identifier &amp;id, std::string &amp;errorMessage)</div><div class="ttdoc">Changes the application id in the storage table.</div></div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_a45e91573073d36a65b5f12b958a5b827"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">DFL::Crypto::Store::requestCertificateFor</a></div><div class="ttdeci">static bool requestCertificateFor(const Component::Key &amp;requester, const CommonName &amp;cn, const Oids &amp;roles=Oids{})</div><div class="ttdoc">Adds the given certificate requester to the storage table.</div></div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_a8a173a5a366b1352a7f18d8e39a69f44"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#a8a173a5a366b1352a7f18d8e39a69f44">DFL::Crypto::Store::generateCsrFor</a></div><div class="ttdeci">static OptionalCsr generateCsrFor(const Component::Key &amp;requester, std::string &amp;errorMessage)</div><div class="ttdoc">Generates a certificate signing request based on the given requestor.</div></div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_ac95b7268df813c62d4a870c8dc33537d"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#ac95b7268df813c62d4a870c8dc33537d">DFL::Crypto::Store::generateKeys</a></div><div class="ttdeci">static bool generateKeys()</div><div class="ttdoc">Generates keys for items in the table which need keys.</div></div>
<div class="ttc" id="agroup___s31_sdc_common_html_gab3f64a46ac4232cc4d580db3bef9a44c"><div class="ttname"><a href="group___s31_sdc_common.html#gab3f64a46ac4232cc4d580db3bef9a44c">S31::Sdc::Impl::roles</a></div><div class="ttdeci">std::string roles(const DFL::Oids &amp;roles)</div><div class="ttdoc">Helper functions to extract certain information and return them in certain format.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac95b7268df813c62d4a870c8dc33537d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac95b7268df813c62d4a870c8dc33537d">&#9670;&nbsp;</a></span>generateKeys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::generateKeys </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Generates keys for items in the table which need keys. </p>
<dl class="section warning"><dt>Warning</dt><dd>Unfortunately generation of keys is quite expensive and due to its nature the duration is quite unpredictable. In environments with constrained CPU resources it is advised to call this function in a low priority context. It only needs to be called once per startup and calling it from only one thread per device is sufficient. The best time is after all modules requested a certificate and before a CSR is generated. Once keys have been generated they are stored persistently. So the next time this function is called it returns quickly. It is fair to assume that most of the time this call returns quickly. But when it is not quick it is very slow.</dd></dl>
<div class="fragment"><div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> optItem{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]};</div>
<div class="line">        ASSERT_TRUE(optItem);</div>
<div class="line">        EXPECT_FALSE(ItemAccess::currentPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_FALSE(ItemAccess::nextPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_EQ(ItemAccess::currentPrivateKey(optItem.value()),</div>
<div class="line">                  optItem-&gt;currentPrivateKey());</div>
<div class="line">        EXPECT_FALSE(optItem-&gt;chain());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// generateKeys generates next key</span></div>
<div class="line">    EXPECT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#ac95b7268df813c62d4a870c8dc33537d">Store::generateKeys</a>());</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> optItem{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]};</div>
<div class="line">        ASSERT_TRUE(optItem);</div>
<div class="line">        EXPECT_FALSE(ItemAccess::currentPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_TRUE(ItemAccess::nextPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_EQ(ItemAccess::nextPrivateKey(optItem.value()),</div>
<div class="line">                  optItem-&gt;currentPrivateKey());</div>
<div class="line">        EXPECT_FALSE(optItem-&gt;chain());</div>
<div class="line">        lastOptItem = optItem;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// generateKeys again does not change anything</span></div>
<div class="line">    ASSERT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#ac95b7268df813c62d4a870c8dc33537d">Store::generateKeys</a>());</div>
<div class="line"> </div>
<div class="line">    EXPECT_EQ(lastOptItem, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// re-init of environment allows regeneration of next key</span></div>
<div class="line">    shutdown();</div>
<div class="line">    init();</div>
<div class="line">    ASSERT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#ac95b7268df813c62d4a870c8dc33537d">Store::generateKeys</a>());</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> optItem{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]};</div>
<div class="line">        ASSERT_TRUE(optItem);</div>
<div class="line">        EXPECT_FALSE(ItemAccess::currentPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_TRUE(ItemAccess::nextPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_NE(ItemAccess::nextPrivateKey(lastOptItem.value()),</div>
<div class="line">                  ItemAccess::nextPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_EQ(ItemAccess::nextPrivateKey(optItem.value()),</div>
<div class="line">                  optItem-&gt;currentPrivateKey());</div>
<div class="line">        EXPECT_FALSE(optItem-&gt;chain());</div>
<div class="line">        lastOptItem = optItem;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// certificateChain sets chain</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> csr1{createCsr(compKey)};</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> chain1{makeChain(createCertificate(csr1))};</div>
<div class="line"> </div>
<div class="line">    result = <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a3b131ca8d9fadb0fd7941fa37e4d806f">Store::certificateChain</a>(chain1, msg);</div>
<div class="line">    ASSERT_TRUE(result) &lt;&lt; msg;</div>
<div class="line">    ASSERT_TRUE(msg.empty());</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> optItem{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]};</div>
<div class="line">        ASSERT_TRUE(optItem);</div>
<div class="line">        EXPECT_EQ(ItemAccess::nextPrivateKey(lastOptItem.value()),</div>
<div class="line">                  ItemAccess::currentPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_FALSE(ItemAccess::nextPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_EQ(ItemAccess::currentPrivateKey(optItem.value()),</div>
<div class="line">                  optItem-&gt;currentPrivateKey());</div>
<div class="line">        ASSERT_TRUE(optItem-&gt;chain());</div>
<div class="line">        EXPECT_EQ(chain1, *optItem-&gt;chain());</div>
<div class="line">        lastOptItem = optItem;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// certificateChain again does not change anything</span></div>
<div class="line">    result = <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a3b131ca8d9fadb0fd7941fa37e4d806f">Store::certificateChain</a>(chain1, msg);</div>
<div class="line">    EXPECT_TRUE(result) &lt;&lt; msg;</div>
<div class="line">    EXPECT_TRUE(msg.empty());</div>
<div class="line"> </div>
<div class="line">    EXPECT_EQ(lastOptItem, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// generateKeys generates next key</span></div>
<div class="line">    EXPECT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#ac95b7268df813c62d4a870c8dc33537d">Store::generateKeys</a>());</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> optItem{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]};</div>
<div class="line">        ASSERT_TRUE(optItem);</div>
<div class="line">        EXPECT_EQ(ItemAccess::currentPrivateKey(lastOptItem.value()),</div>
<div class="line">                  ItemAccess::currentPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_TRUE(ItemAccess::nextPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_NE(ItemAccess::currentPrivateKey(optItem.value()),</div>
<div class="line">                  ItemAccess::nextPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_EQ(ItemAccess::currentPrivateKey(optItem.value()),</div>
<div class="line">                  optItem-&gt;currentPrivateKey());</div>
<div class="line">        ASSERT_TRUE(optItem-&gt;chain());</div>
<div class="line">        EXPECT_EQ(chain1, *optItem-&gt;chain());</div>
<div class="line">        lastOptItem = optItem;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// generateKeys again does not change anything</span></div>
<div class="line">    EXPECT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#ac95b7268df813c62d4a870c8dc33537d">Store::generateKeys</a>());</div>
<div class="line"> </div>
<div class="line">    EXPECT_EQ(lastOptItem, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// certificateChain with current key is not accepted anymore</span></div>
<div class="line">    result = <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a3b131ca8d9fadb0fd7941fa37e4d806f">Store::certificateChain</a>(chain1, msg);</div>
<div class="line">    EXPECT_FALSE(result) &lt;&lt; msg;</div>
<div class="line">    EXPECT_FALSE(msg.empty());</div>
<div class="line"> </div>
<div class="line">    EXPECT_EQ(lastOptItem, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// certificateChain with next key is accepted; current key = next key</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> csr2{createCsr(compKey)};</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> chain2{makeChain(createCertificate(csr2))};</div>
<div class="line"> </div>
<div class="line">    result = <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a3b131ca8d9fadb0fd7941fa37e4d806f">Store::certificateChain</a>(chain2, msg);</div>
<div class="line">    EXPECT_TRUE(result) &lt;&lt; msg;</div>
<div class="line">    EXPECT_TRUE(msg.empty());</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> optItem{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]};</div>
<div class="line">        ASSERT_TRUE(optItem);</div>
<div class="line">        EXPECT_EQ(ItemAccess::nextPrivateKey(lastOptItem.value()),</div>
<div class="line">                  ItemAccess::currentPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_FALSE(ItemAccess::nextPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_EQ(ItemAccess::currentPrivateKey(optItem.value()),</div>
<div class="line">                  optItem-&gt;currentPrivateKey());</div>
<div class="line">        ASSERT_TRUE(optItem-&gt;chain());</div>
<div class="line">        EXPECT_EQ(chain2, *optItem-&gt;chain());</div>
<div class="line">        lastOptItem = optItem;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// removeKeyFor with current and next key</span></div>
<div class="line">    EXPECT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#ac95b7268df813c62d4a870c8dc33537d">Store::generateKeys</a>());</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> optItem{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]};</div>
<div class="line">        ASSERT_TRUE(optItem);</div>
<div class="line">        EXPECT_TRUE(ItemAccess::currentPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_TRUE(ItemAccess::nextPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_EQ(ItemAccess::currentPrivateKey(optItem.value()),</div>
<div class="line">                  optItem-&gt;currentPrivateKey());</div>
<div class="line">        ASSERT_TRUE(optItem-&gt;chain());</div>
<div class="line">        EXPECT_EQ(chain2, *optItem-&gt;chain());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    result = <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a31d2e5d5aaf15ab98847f0ab11b71414">Store::removeKeyFor</a>(compKey, msg);</div>
<div class="line">    EXPECT_TRUE(result) &lt;&lt; msg;</div>
<div class="line">    EXPECT_TRUE(msg.empty());</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> optItem{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]};</div>
<div class="line">        ASSERT_TRUE(optItem);</div>
<div class="line">        EXPECT_FALSE(ItemAccess::currentPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_FALSE(ItemAccess::nextPrivateKey(optItem.value()));</div>
<div class="line">        EXPECT_EQ(ItemAccess::currentPrivateKey(optItem.value()),</div>
<div class="line">                  optItem-&gt;currentPrivateKey());</div>
<div class="line">        ASSERT_TRUE(optItem-&gt;chain());</div>
<div class="line">        EXPECT_EQ(chain2, *optItem-&gt;chain());</div>
<div class="line">    }</div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_a31d2e5d5aaf15ab98847f0ab11b71414"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#a31d2e5d5aaf15ab98847f0ab11b71414">DFL::Crypto::Store::removeKeyFor</a></div><div class="ttdeci">static bool removeKeyFor(const Component::Key &amp;requester, std::string &amp;errorMessage)</div><div class="ttdoc">Removes key for the given requester.</div></div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_a3b131ca8d9fadb0fd7941fa37e4d806f"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#a3b131ca8d9fadb0fd7941fa37e4d806f">DFL::Crypto::Store::certificateChain</a></div><div class="ttdeci">static bool certificateChain(const CertificateChain &amp;chain)</div><div class="ttdoc">Adds the given chain to the storage table.</div></div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_a40a548e42a4eac15b778732ab26bf4fe"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">DFL::Crypto::Store::table</a></div><div class="ttdeci">static Table table()</div><div class="ttdoc">Returns the storage table.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8fd2666f9f67d44aa654253a52136ad9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fd2666f9f67d44aa654253a52136ad9">&#9670;&nbsp;</a></span>removeAllRootCasFor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::removeAllRootCasFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove all root cas for the given requester. </p>
<p>Same as <a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a9b9d74c95b1f652ffff89c06abc81723">DFL::Crypto::Store::rootCasFor</a> with empty root cas.</p>
<div class="fragment"><div class="line">    ASSERT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a8fd2666f9f67d44aa654253a52136ad9">Store::removeAllRootCasFor</a>(compKey, msg)) &lt;&lt; msg;</div>
<div class="line">    ASSERT_TRUE(msg.empty());</div>
<div class="line">    ASSERT_EQ(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]-&gt;rootCas(),</div>
<div class="line">              <a class="code" href="group___crypto.html#ga7731f2c7313c473dc54a1918564a06a1">RootCas</a>{KnownRootCas::deviceRootCa()});</div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_a8fd2666f9f67d44aa654253a52136ad9"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#a8fd2666f9f67d44aa654253a52136ad9">DFL::Crypto::Store::removeAllRootCasFor</a></div><div class="ttdeci">static bool removeAllRootCasFor(const Component::Key &amp;requester, std::string &amp;errorMessage)</div><div class="ttdoc">Remove all root cas for the given requester.</div></div>
<div class="ttc" id="agroup___crypto_html_ga7731f2c7313c473dc54a1918564a06a1"><div class="ttname"><a href="group___crypto.html#ga7731f2c7313c473dc54a1918564a06a1">DFL::Crypto::RootCas</a></div><div class="ttdeci">Certificates RootCas</div><div class="ttdoc">Just a semantic alias but same as DFL::Crypto::Certificates.</div><div class="ttdef"><b>Definition:</b> RootCas.h:13</div></div>
</div><!-- fragment --> <dl class="section return"><dt>Returns</dt><dd>Same as <a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a9b9d74c95b1f652ffff89c06abc81723">DFL::Crypto::Store::rootCasFor</a>. </dd></dl>

</div>
</div>
<a id="a3bf7f32504c045c84535438dbc08e468"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bf7f32504c045c84535438dbc08e468">&#9670;&nbsp;</a></span>removeCertificateChainFor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::removeCertificateChainFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes the chain for the given requester. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">requester</td><td></td></tr>
    <tr><td class="paramname">errorMessage</td><td>If the function returns false, this string will contain a detailed error message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

</div>
</div>
<a id="a31d2e5d5aaf15ab98847f0ab11b71414"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31d2e5d5aaf15ab98847f0ab11b71414">&#9670;&nbsp;</a></span>removeKeyFor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::removeKeyFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Removes key for the given requester. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">requester</td><td></td></tr>
    <tr><td class="paramname">errorMessage</td><td>If the function returns false, this string will contain a detailed error message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

</div>
</div>
<a id="a8fb8b1e31ea2a2dff01c1ddffcb7bb2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fb8b1e31ea2a2dff01c1ddffcb7bb2e">&#9670;&nbsp;</a></span>removeRoleAuthorizationListFor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::removeRoleAuthorizationListFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove role authorization list for the given requester. </p>
<p>Same as <a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a7708024c7bb522acb4bd0fad49d9067e">DFL::Crypto::Store::roleAuthorizationListFor</a> with empty ral.</p>
<div class="fragment"><div class="line">    ASSERT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a8fb8b1e31ea2a2dff01c1ddffcb7bb2e">Store::removeRoleAuthorizationListFor</a>(compKey, msg)) &lt;&lt; msg;</div>
<div class="line">    ASSERT_TRUE(msg.empty());</div>
<div class="line">    ASSERT_EQ(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]-&gt;roleAuthorizationList(),</div>
<div class="line">              RoleAuthorizationList{});</div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_a8fb8b1e31ea2a2dff01c1ddffcb7bb2e"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#a8fb8b1e31ea2a2dff01c1ddffcb7bb2e">DFL::Crypto::Store::removeRoleAuthorizationListFor</a></div><div class="ttdeci">static bool removeRoleAuthorizationListFor(const Component::Key &amp;requester, std::string &amp;errorMessage)</div><div class="ttdoc">Remove role authorization list for the given requester.</div></div>
</div><!-- fragment --> <dl class="section return"><dt>Returns</dt><dd>Same as <a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a7708024c7bb522acb4bd0fad49d9067e">DFL::Crypto::Store::roleAuthorizationListFor</a>. </dd></dl>

</div>
</div>
<a id="a45e91573073d36a65b5f12b958a5b827"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45e91573073d36a65b5f12b958a5b827">&#9670;&nbsp;</a></span>requestCertificateFor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::requestCertificateFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group___crypto.html#ga38d524ff4b8ecbb39379e33c25bfb5dc">CommonName</a> &amp;&#160;</td>
          <td class="paramname"><em>cn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_oids.html">Oids</a> &amp;&#160;</td>
          <td class="paramname"><em>roles</em> = <code><a class="el" href="class_d_f_l_1_1_oids.html">Oids</a>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds the given certificate requester to the storage table. </p>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd>
<dd>
false if cn is empty </dd>
<dd>
false if requester is already in store but with different common name or different roles</dd></dl>
<div class="fragment"><div class="line">    <span class="keyword">auto</span> expected{<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()};</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// table item with compKey</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// empty common name is not allowed</span></div>
<div class="line">    EXPECT_FALSE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(compKey, <a class="code" href="group___crypto.html#ga38d524ff4b8ecbb39379e33c25bfb5dc">CommonName</a>{}));</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> item0{createTableItem(compKey, commonName, Oids{})};</div>
<div class="line">    TableAccess{&amp;expected}.insert(item0);</div>
<div class="line"> </div>
<div class="line">    EXPECT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(compKey, commonName));</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ensure other properties are not overwritten</span></div>
<div class="line">    setOtherProperties(&amp;item0);</div>
<div class="line">    TableAccess{&amp;expected}.insert(item0);</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calling with same args is allowed</span></div>
<div class="line">    EXPECT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(compKey, commonName));</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// changing common name is not allowed</span></div>
<div class="line">    EXPECT_FALSE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(compKey, anotherCommonName));</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// changing roles is allowed</span></div>
<div class="line">    ItemAccess{&amp;item0}.roles(<a class="code" href="group___s31_sdc_common.html#gab3f64a46ac4232cc4d580db3bef9a44c">roles</a>);</div>
<div class="line">    TableAccess{&amp;expected}.insert(item0);</div>
<div class="line">    EXPECT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(compKey, commonName, <a class="code" href="group___s31_sdc_common.html#gab3f64a46ac4232cc4d580db3bef9a44c">roles</a>));</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// table item with compKey &amp; table item with anotherCompKey</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// empty common name not allowed</span></div>
<div class="line">    EXPECT_FALSE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(anotherCompKey, <a class="code" href="group___crypto.html#ga38d524ff4b8ecbb39379e33c25bfb5dc">CommonName</a>{}));</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> item1{createTableItem(anotherCompKey, commonName, <a class="code" href="group___s31_sdc_common.html#gab3f64a46ac4232cc4d580db3bef9a44c">roles</a>)};</div>
<div class="line">    TableAccess{&amp;expected}.insert(item1);</div>
<div class="line"> </div>
<div class="line">    EXPECT_TRUE(</div>
<div class="line">        <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(anotherCompKey, commonName, <a class="code" href="group___s31_sdc_common.html#gab3f64a46ac4232cc4d580db3bef9a44c">roles</a>));</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ensure other properties are not overwritten</span></div>
<div class="line">    setOtherProperties(&amp;item1);</div>
<div class="line">    TableAccess{&amp;expected}.insert(item1);</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calling with same args is allowed</span></div>
<div class="line">    EXPECT_TRUE(</div>
<div class="line">        <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(anotherCompKey, commonName, <a class="code" href="group___s31_sdc_common.html#gab3f64a46ac4232cc4d580db3bef9a44c">roles</a>));</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// changing common name is not allowed</span></div>
<div class="line">    EXPECT_FALSE(</div>
<div class="line">        <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(anotherCompKey, anotherCommonName));</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// changing roles is allowed</span></div>
<div class="line">    ItemAccess{&amp;item1}.roles(anotherRoles);</div>
<div class="line">    TableAccess{&amp;expected}.insert(item1);</div>
<div class="line">    EXPECT_TRUE(</div>
<div class="line">        <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a45e91573073d36a65b5f12b958a5b827">Store::requestCertificateFor</a>(anotherCompKey, commonName, anotherRoles));</div>
<div class="line">    EXPECT_EQ(expected, <a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>());</div>
<div class="ttc" id="agroup___crypto_html_ga38d524ff4b8ecbb39379e33c25bfb5dc"><div class="ttname"><a href="group___crypto.html#ga38d524ff4b8ecbb39379e33c25bfb5dc">DFL::Crypto::CommonName</a></div><div class="ttdeci">BasicAttributeTypeAndValue&lt; Impl::CnType &gt; CommonName</div><div class="ttdoc">Represents a common name.</div><div class="ttdef"><b>Definition:</b> AttributeTypeAndValue.h:171</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7708024c7bb522acb4bd0fad49d9067e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7708024c7bb522acb4bd0fad49d9067e">&#9670;&nbsp;</a></span>roleAuthorizationListFor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::roleAuthorizationListFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_crypto_1_1_role_authorization_list.html">RoleAuthorizationList</a> &amp;&#160;</td>
          <td class="paramname"><em>ral</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a role authorization list for the given requester to the storage table. </p>
<p>If the function returns false <code>errorMessage</code> will contain details. Otherwise it is empty.</p>
<div class="fragment"><div class="line">    ASSERT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a7708024c7bb522acb4bd0fad49d9067e">Store::roleAuthorizationListFor</a>(compKey, ral(), msg)) &lt;&lt; msg;</div>
<div class="line">    ASSERT_TRUE(msg.empty());</div>
<div class="line">    ASSERT_EQ(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]-&gt;roleAuthorizationList(), ral());</div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_a7708024c7bb522acb4bd0fad49d9067e"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#a7708024c7bb522acb4bd0fad49d9067e">DFL::Crypto::Store::roleAuthorizationListFor</a></div><div class="ttdeci">static bool roleAuthorizationListFor(const Component::Key &amp;requester, const RoleAuthorizationList &amp;ral, std::string &amp;errorMessage)</div><div class="ttdoc">Adds a role authorization list for the given requester to the storage table.</div></div>
</div><!-- fragment --> <dl class="section return"><dt>Returns</dt><dd>True on success otherwise false. </dd></dl>

</div>
</div>
<a id="a9b9d74c95b1f652ffff89c06abc81723"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b9d74c95b1f652ffff89c06abc81723">&#9670;&nbsp;</a></span>rootCasFor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::rootCasFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group___crypto.html#ga7731f2c7313c473dc54a1918564a06a1">RootCas</a> &amp;&#160;</td>
          <td class="paramname"><em>rootCas</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds root cas for the given requester to the storage table. </p>
<p>If the function returns false <code>errorMessage</code> will contain details. Otherwise it is empty.</p>
<div class="fragment"><div class="line">    ASSERT_TRUE(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a9b9d74c95b1f652ffff89c06abc81723">Store::rootCasFor</a>(compKey, rootCas(), msg)) &lt;&lt; msg;</div>
<div class="line">    ASSERT_TRUE(msg.empty());</div>
<div class="line">    ASSERT_EQ(<a class="code" href="class_d_f_l_1_1_crypto_1_1_store.html#a40a548e42a4eac15b778732ab26bf4fe">Store::table</a>()[compKey]-&gt;rootCas(), rootCas());</div>
<div class="ttc" id="aclass_d_f_l_1_1_crypto_1_1_store_html_a9b9d74c95b1f652ffff89c06abc81723"><div class="ttname"><a href="class_d_f_l_1_1_crypto_1_1_store.html#a9b9d74c95b1f652ffff89c06abc81723">DFL::Crypto::Store::rootCasFor</a></div><div class="ttdeci">static bool rootCasFor(const Component::Key &amp;requester, const RootCas &amp;rootCas, std::string &amp;errorMessage)</div><div class="ttdoc">Adds root cas for the given requester to the storage table.</div></div>
</div><!-- fragment --> <dl class="section return"><dt>Returns</dt><dd>True on success otherwise false. </dd></dl>

</div>
</div>
<a id="a40a548e42a4eac15b778732ab26bf4fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40a548e42a4eac15b778732ab26bf4fe">&#9670;&nbsp;</a></span>table() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="class_d_f_l_1_1_crypto_1_1_table.html">Table</a> DFL::Crypto::Store::table </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the storage table. </p>
<dl class="section return"><dt>Returns</dt><dd>In case of an error, an empty table will be returned </dd></dl>

</div>
</div>
<a id="a01a9518169285ec7188d23ccfc7493ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01a9518169285ec7188d23ccfc7493ae">&#9670;&nbsp;</a></span>table() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="class_d_f_l_1_1_crypto_1_1_store.html#a61760874d25d8cbd76a1eca1a2bd976b">OptionalTable</a> DFL::Crypto::Store::table </td>
          <td>(</td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the storage table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorMessage</td><td>If the function returns 'none', this string will contain a detailed error message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>In case of an error, 'none' will be returned </dd></dl>

</div>
</div>
<a id="a367a8a86db8f540beab5b548c6b0a95a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a367a8a86db8f540beab5b548c6b0a95a">&#9670;&nbsp;</a></span>whitelistFor() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::whitelistFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_crypto_1_1_whitelist.html">Whitelist</a> &amp;&#160;</td>
          <td class="paramname"><em>list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a white list for the given requester to the storage table. </p>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

</div>
</div>
<a id="a91c8135f758c52294727cf774380f979"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91c8135f758c52294727cf774380f979">&#9670;&nbsp;</a></span>whitelistFor() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool DFL::Crypto::Store::whitelistFor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_component_1_1_key.html">Component::Key</a> &amp;&#160;</td>
          <td class="paramname"><em>requester</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_d_f_l_1_1_crypto_1_1_whitelist.html">Whitelist</a> &amp;&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string &amp;&#160;</td>
          <td class="paramname"><em>errorMessage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a white list for the given requester to the storage table. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">requester</td><td></td></tr>
    <tr><td class="paramname">list</td><td></td></tr>
    <tr><td class="paramname">errorMessage</td><td>If the function returns false, this string will contain a detailed error message </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>Framework/Crypto/Public/<a class="el" href="_public_2_store_8h_source.html">Store.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Sep 13 2023 13:32:06 for Product Core System (PCS) by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
